# Story 1.1: Project Infrastructure Setup

## Status
Draft

## Story
**As a** developer,
**I want** a fully configured development environment with project scaffolding,
**so that** I can begin building DocGraph features with proper tooling, testing, and deployment pipelines in place.

## Acceptance Criteria
1. Monorepo structure established with frontend (React + shadcn/ui) and backend (Python FastAPI) separation
2. Docker containerization configured for both development and production environments
3. CI/CD pipeline configured with automated testing and deployment workflows
4. Database services (pgvector + Neo4j) containerized and integrated
5. Basic health check endpoints operational with monitoring capabilities
6. TypeScript and Python type checking integrated into development workflow
7. Testing frameworks configured (Jest/Vitest for frontend, pytest for backend)

## Tasks / Subtasks
- [ ] **Task 1: Initialize Monorepo Structure** (AC: 1)
  - [ ] Create Nx workspace with TypeScript configuration
  - [ ] Set up apps/web/ directory for React frontend
  - [ ] Set up apps/api/ directory for Python FastAPI backend
  - [ ] Configure packages/shared/ for shared TypeScript types
  - [ ] Create root package.json with workspace configuration
  - [ ] Configure .gitignore for monorepo structure

- [ ] **Task 2: Frontend Application Setup** (AC: 1, 6)
  - [ ] Initialize React 18.2+ with TypeScript 5.3+ in apps/web/
  - [ ] Install and configure shadcn/ui component library
  - [ ] Set up Tailwind CSS 3.3+ configuration
  - [ ] Configure Vite 5.0+ for build tooling and HMR
  - [ ] Install Zustand 4.4+ for state management
  - [ ] Set up TypeScript path aliases and strict type checking
  - [ ] Create basic project structure following unified-project-structure.md

- [ ] **Task 3: Backend Application Setup** (AC: 1, 6)
  - [ ] Initialize FastAPI 0.104+ application in apps/api/
  - [ ] Set up Python 3.11+ virtual environment and requirements
  - [ ] Configure project structure following backend-architecture.md
  - [ ] Install SQLAlchemy, Alembic for database ORM
  - [ ] Install boto3 for AWS services integration
  - [ ] Set up environment configuration and validation
  - [ ] Configure Python type checking with mypy

- [ ] **Task 4: Database Services Configuration** (AC: 4)
  - [ ] Create docker-compose.yml with PostgreSQL 15+ and pgvector extension
  - [ ] Add Neo4j 5.15+ container with proper authentication
  - [ ] Configure Redis 7.2+ for caching and sessions
  - [ ] Set up database connection utilities following database.py pattern
  - [ ] Create initial database migration for core tables (users, projects)
  - [ ] Verify database connectivity from backend application

- [ ] **Task 5: Docker Containerization** (AC: 2)
  - [ ] Create Dockerfile for frontend with multi-stage build
  - [ ] Create Dockerfile for backend with Python dependencies
  - [ ] Set up docker-compose for development environment
  - [ ] Configure production Docker images with optimization
  - [ ] Add health check endpoints for container orchestration
  - [ ] Test container builds and inter-service communication

- [ ] **Task 6: Testing Framework Configuration** (AC: 7)
  - [ ] Set up Vitest + Testing Library for frontend in apps/web/tests/
  - [ ] Configure pytest + FastAPI TestClient for backend in apps/api/tests/
  - [ ] Install Playwright for E2E testing
  - [ ] Create test configuration files and mock utilities
  - [ ] Set up test coverage reporting with nyc/coverage.py
  - [ ] Create sample tests for basic functionality

- [ ] **Task 7: CI/CD Pipeline Setup** (AC: 3, 5)
  - [ ] Create .github/workflows/ci.yaml for automated testing
  - [ ] Configure parallel testing for frontend and backend
  - [ ] Set up Docker image building and pushing
  - [ ] Add code quality checks (ESLint, Black, mypy)
  - [ ] Configure test coverage reporting
  - [ ] Add basic health check endpoint validation

- [ ] **Task 8: Health Check and Monitoring** (AC: 5)
  - [ ] Create /health endpoint in FastAPI backend
  - [ ] Add database connectivity check
  - [ ] Create frontend health indicator component
  - [ ] Configure basic logging with Winston and structured logs
  - [ ] Set up monitoring preparation for CloudWatch integration
  - [ ] Test monitoring endpoints and logging output

## Dev Notes

### Previous Story Insights
No previous story exists - this is the foundational story for the project.

### Tech Stack Requirements
[Source: architecture/tech-stack.md]
- **Frontend**: React 18.2+ with TypeScript 5.3+, shadcn/ui, Zustand 4.4+, Tailwind CSS 3.3+
- **Backend**: Python 3.11+ with FastAPI 0.104+, SQLAlchemy, boto3
- **Build Tools**: Vite 5.0+ for frontend, Nx for monorepo management
- **Databases**: PostgreSQL 15+ with pgvector, Neo4j 5.15+, Redis 7.2+
- **Testing**: Vitest + Testing Library (frontend), pytest + FastAPI TestClient (backend), Playwright (E2E)
- **CI/CD**: GitHub Actions, Docker containerization

### Project Structure Requirements
[Source: architecture/unified-project-structure.md]
```
docgraph/
├── .github/workflows/          # CI/CD workflows
├── apps/
│   ├── web/                    # React frontend (Next.js/Vite)
│   │   ├── src/components/ui/  # shadcn/ui components
│   │   ├── src/hooks/          # Custom React hooks
│   │   ├── src/services/       # API client services
│   │   ├── src/stores/         # Zustand state management
│   │   └── tests/              # Frontend tests (Vitest)
│   └── api/                    # Python FastAPI backend
│       ├── src/handlers/       # Lambda function handlers
│       ├── src/services/       # Business logic services
│       ├── src/models/         # Data access layer
│       └── tests/              # Backend tests (pytest)
├── packages/shared/            # Shared TypeScript types
├── infrastructure/             # AWS CDK (future)
└── scripts/                    # Build and deployment scripts
```

### Database Schema Requirements
[Source: architecture/database-schema.md]
- PostgreSQL extensions: pgvector, uuid-ossp
- Core tables: users (Cognito integration), projects, template_zones, documents
- Neo4j for relationship data with proper constraints and indexes
- Connection pooling and migration strategy with Alembic

### Coding Standards
[Source: architecture/coding-standards.md]
- **Type Sharing**: All shared types in packages/shared directory
- **API Calls**: Service layer pattern, never direct HTTP calls in components
- **Environment Variables**: Config objects, never direct process.env access
- **Error Handling**: Standard error handler for all API routes
- **Database**: Repository pattern for all queries
- **Naming**: PascalCase (components), camelCase (hooks), snake_case (database)

### Deployment Strategy
[Source: architecture/deployment-architecture.md]
- **Frontend**: Vercel with Next.js optimization, `nx build web`
- **Backend**: AWS Lambda with Serverless Framework, `nx build api`
- **Infrastructure**: AWS CDK for IaC
- **CI/CD**: GitHub Actions with parallel frontend/backend testing

### Testing Requirements
[Source: architecture/testing-strategy.md]
- **Test Pyramid**: E2E (10%), Integration (30%), Unit Tests (60% split frontend/backend)
- **Frontend Tests**: Component tests in apps/web/tests/, hook tests, service tests
- **Backend Tests**: Unit tests in apps/api/tests/unit/, integration in tests/integration/
- **Mocks**: Centralized in __mocks__/ directories
- **Coverage**: Minimum thresholds to be established

### Testing
**Test File Locations:**
- Frontend: `apps/web/tests/` with component, hook, and service test directories
- Backend: `apps/api/tests/` with unit and integration test separation

**Test Standards:**
- Use Vitest + Testing Library for React component testing
- Use pytest + FastAPI TestClient for backend API testing
- Use Playwright for E2E testing with proper selectors
- Maintain test coverage reporting and minimum thresholds
- Mock external services and APIs consistently

**Testing Patterns:**
- Repository pattern testing with database abstractions
- Component testing with proper user interaction simulation
- API testing with request/response validation
- Integration testing for database and external service connections

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-24 | 1.0 | Initial story creation from Epic 1.1 | SM Bob |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*This section will be populated by QA Agent after story completion*